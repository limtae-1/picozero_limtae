from picozero import WaterLevelSensor
import time

# 수위 감지 센서 설정
# 아날로그 핀 26번 사용
# 아날로그 핀은 라즈베리파이피코 핀맵을 통해 확인하기
water_sensor = WaterLevelSensor(pin=26, threshold=0.9)


while True:
    if water_sensor.is_water_level_high():
        print("Water level is HIGH!")
    else:
        print("Water level is LOW!")
    
    time.sleep(1)  # 1초마다 수위 체크
    
'''
임계값을 수정 하려면 threshold를 바꾸면
수위 임계값을 0.6으로 설정했다면, 이는 센서가 읽은 값이
전체 가능한 값의 60%에 도달했을 때 "수위가 높다"고 판단한다는 의미입니다.
임계값은 시스템의 요구 사항에 따라 조정될 수 있습니다.
예를 들어, 수위가 너무 높아지기 전에 알림을 받으려면 임계값을 낮추고,
반대로 경고를 덜 받으려면 임계값을 높일 수 있습니다.
'''
'''
수위의 임계값에 대한 설명을 이해하기 위해서는 먼저 수위 감지 센서가 어떻게 동작하는지를 알아야 합니다.

1. 수위 감지 센서의 동작 원리
수위 감지 센서는 액체의 높이를 감지하여 아날로그 신호(전압 값)를 출력합니다.
이 전압 값은 일반적으로 0V에서 3.3V 사이이며, 물의 높이에 따라 변화합니다.
라즈베리파이 피코와 같은 마이크로컨트롤러는 이 전압을 읽어 0부터 65535 사이의 값으로 변환합니다.
이 값은 센서가 감지한 수위에 비례합니다.

2. 임계값의 개념
임계값이란, 특정한 조건이 충족되었음을 나타내는 경계값을 의미합니다.
수위 감지 센서의 경우, 이 임계값은 센서가 감지한 전압 또는 아날로그 값이 일정 수준에 도달했을 때,
수위가 충분히 높거나 낮다는 결정을 내리기 위한 기준이 됩니다.

3. 임계값의 설정 기준
임계값의 설정은 다음과 같은 요소를 기반으로 합니다:

센서의 특성: 각 수위 감지 센서는 특정 범위의 전압을 출력합니다. 예를 들어, 센서가 물이 최대 높이에 있을 때 3.0V를 출력하고,
물이 전혀 없을 때 0V를 출력한다고 가정합니다.
목적에 따른 기준: 예를 들어, 물탱크가 거의 가득 찼을 때 경고를 발생시키고 싶다면, 임계값을 2.5V로 설정할 수 있습니다.
이렇게 하면, 센서가 2.5V 이상의 전압을 감지할 때 "수위가 높다"는 경고를 보낼 수 있습니다.
안전 마진: 임계값을 설정할 때, 안전 마진을 고려할 수 있습니다. 즉, 물이 실제로 탱크의 꼭대기에 도달하기 전에 미리 경고를
보내도록 임계값을 약간 낮게 설정할 수 있습니다.
'''